{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "data-table-virtual",
  "type": "registry:ui",
  "title": "Data Table Virtualized",
  "description": "Data Table Virtualized componet with wrapper",
  "dependencies": [
    "@tanstack/react-virtual"
  ],
  "files": [
    {
      "path": "components/ui/data-table/data-table-virtualized.tsx",
      "content": "\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport { type VirtualizerOptions, useVirtualizer } from \"@tanstack/react-virtual\";\r\nimport { flexRender, Table as TanstackTable } from \"@tanstack/react-table\";\r\nimport { Loader } from \"lucide-react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nimport {\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\n\r\ninterface DataTableProps<TData> {\r\n  table: TanstackTable<TData>\r\n  emptyMessage?: string\r\n  className?: string\r\n  hasNextPage?: boolean\r\n  isFetchingNextPage?: boolean\r\n  fetchNextPage?: () => void\r\n  virtualizerOptions?: Partial<Omit<VirtualizerOptions<HTMLDivElement, Element>, 'count' | 'getScrollElement'>>\r\n}\r\n\r\nexport function DataTableVirtualized<TData>({\r\n  table,\r\n  emptyMessage = \"No matching results.\",\r\n  className = \"\",\r\n  hasNextPage = false,\r\n  isFetchingNextPage = false,\r\n  fetchNextPage = () => { },\r\n  virtualizerOptions,\r\n}: DataTableProps<TData>) {\r\n  const rows = table.getRowModel().rows\r\n  const columnCount = table.getAllColumns().length\r\n  const hasRows = rows.length > 0\r\n\r\n  const parentRef = useRef<HTMLDivElement>(null)\r\n\r\n  const virtualizer = useVirtualizer({\r\n    count: hasNextPage ? rows.length + 1 : rows.length,\r\n    getScrollElement: () => parentRef.current,\r\n    estimateSize: () => 81,\r\n    overscan: 10,\r\n    ...(virtualizerOptions ?? {}),\r\n  })\r\n\r\n  const virtualItems = virtualizer.getVirtualItems()\r\n\r\n  useEffect(() => {\r\n    const [lastItem] = [...virtualItems].reverse()\r\n\r\n    if (!lastItem) return\r\n\r\n    if (lastItem.index >= rows.length - 1 && hasNextPage && !isFetchingNextPage) {\r\n      fetchNextPage?.()\r\n    }\r\n  }, [rows.length, hasNextPage, virtualItems, isFetchingNextPage, fetchNextPage])\r\n\r\n  return (\r\n    <div\r\n      ref={parentRef}\r\n      className={cn(\"overflow-auto\", className)}\r\n    >\r\n      <div style={{ height: `${virtualizer.getTotalSize()}px` }}>\r\n        <table className=\"w-full caption-bottom text-sm\">\r\n          <TableHeader>\r\n            {table.getHeaderGroups().map((headerGroup) => (\r\n              <TableRow key={headerGroup.id} className=\"hover:bg-transparent\">\r\n                {headerGroup.headers.map((header) => (\r\n                  <TableHead key={header.id} className=\"text-theme-grey-text\">\r\n                    {header.isPlaceholder\r\n                      ? null\r\n                      : flexRender(\r\n                        header.column.columnDef.header,\r\n                        header.getContext()\r\n                      )}\r\n                  </TableHead>\r\n                ))}\r\n              </TableRow>\r\n            ))}\r\n          </TableHeader>\r\n\r\n          <TableBody>\r\n            {hasRows ? (\r\n              virtualItems.map((virtualRow, index) => {\r\n                const isLoaderRow = virtualRow.index > rows.length - 1\r\n                const row = rows[virtualRow.index]\r\n\r\n                if (!row) {\r\n                  if (isLoaderRow && hasNextPage) {\r\n                    return (\r\n                      <TableRow\r\n                        key=\"loader\"\r\n                        ref={virtualizer.measureElement}\r\n                        data-index={virtualRow.index}\r\n                        style={{\r\n                          height: `${virtualRow.size}px`,\r\n                          transform: `translateY(${virtualRow.start - index * virtualRow.size}px)`,\r\n                        }}\r\n                      >\r\n                        <TableCell colSpan={columnCount}>\r\n                          <div className=\"dc\">\r\n                            <Loader className=\"animate-spin\" />\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    )\r\n                  }\r\n                  return null\r\n                }\r\n\r\n                return (\r\n                  <TableRow\r\n                    key={row.id}\r\n                    ref={virtualizer.measureElement}\r\n                    data-state={row?.getIsSelected?.() && \"selected\"}\r\n                    data-index={virtualRow.index}\r\n                    className=\"hover:bg-muted/40\"\r\n                    style={{\r\n                      height: `${virtualRow.size}px`,\r\n                      transform: `translateY(${virtualRow.start - (isLoaderRow ? index - 1 : index) * virtualRow.size}px)`,\r\n                    }}\r\n                  >\r\n                    {\r\n                      row?.getVisibleCells()?.map((cell) => (\r\n                        <TableCell\r\n                          key={cell.id}\r\n                          className=\"text-[13px] capitalize\"\r\n                        >\r\n                          {flexRender(\r\n                            cell.column.columnDef.cell,\r\n                            cell.getContext()\r\n                          )}\r\n                        </TableCell>\r\n                      ))\r\n                    }\r\n                  </TableRow>\r\n                )\r\n              })\r\n            ) : (\r\n              <TableRow className=\"hover:bg-transparent\">\r\n                <TableCell colSpan={columnCount} className=\"border-b\">\r\n                  <div className=\"dc h-32 my-4 text-sm text-center\">{emptyMessage}</div>\r\n                </TableCell>\r\n              </TableRow>\r\n            )}\r\n          </TableBody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/data-table/index.tsx",
      "content": "export * from \"./data-table-virtualized\";\r\nexport * from \"./column-faceted-filter\";\r\nexport * from \"./column-header\";\r\nexport * from \"./column-filter\";\r\nexport * from \"./column-sorter\";\r\nexport * from \"./column-toggle\";\r\nexport * from \"./filter-group\";\r\nexport * from \"./pagination\";\r\nexport * from \"./data-table\";\r\nexport * from \"./use-table\";",
      "type": "registry:ui"
    }
  ]
}